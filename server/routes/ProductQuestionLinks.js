import db from '../../db/db.js';
import path from 'path';
// import pLimit from 'p-limit';

import dotenv from 'dotenv';

import { defineConfig, loadEnv } from 'vite';
dotenv.config()

const env = loadEnv(
  'all',
  process.cwd()
);



const QueryFile = db.$config.pgp.QueryFile;
const __dirname = path.resolve();
const environment = env.VITE_NODE_ENV

const productQuestions = [["1","vr_b"],["1","vr_d"],["1","hr_b"],["1","hr_d"],["1","rk_b"],["1","rk_d"],["1","rs_b"],["1","rs_d"],["2","vr_b"],["2","vr_d"],["2","hr_b"],["2","hr_d"],["2","rk_b"],["2","rk_d"],["2","rs_b"],["2","rs_d"],["3","vr_b"],["3","vr_d"],["3","hr_b"],["3","hr_d"],["3","rk_b"],["3","rk_d"],["3","rs_b"],["3","rs_d"],["4","vr_b"],["4","vr_d"],["4","hr_b"],["4","hr_d"],["4","rk_b"],["4","rk_d"],["4","rs_b"],["4","rs_d"],["5","vr_b"],["5","vr_d"],["5","hr_b"],["5","hr_d"],["5","rk_b"],["5","rk_d"],["5","rs_b"],["5","rs_d"],["6","vr_b"],["6","vr_d"],["6","hr_b"],["6","hr_d"],["6","rk_b"],["6","rk_d"],["6","rs_b"],["6","rs_d"],["7","vr_d"],["7","hr_d"],["7","rk_d"],["7","rs_d"],["7","3b_d"],["7","3f_d"],["7","5b_d"],["7","5f_d"],["7","7b_d"],["7","7f_d"],["7","9r_d"],["7","lk_c"],["7","lh_c"],["8","vr_d"],["8","hr_d"],["8","rk_d"],["8","rs_d"],["9","vr_b"],["9","vr_d"],["9","hr_b"],["9","hr_d"],["9","rk_b"],["9","rk_d"],["9","rs_b"],["9","rs_d"],["10","vr_b"],["10","vr_d"],["10","hr_b"],["10","hr_d"],["10","rk_b"],["10","rk_d"],["10","rs_b"],["10","rs_d"],["11","vr_d"],["11","hr_d"],["11","rk_d"],["11","rs_d"],["12","vr_b"],["12","vr_d"],["12","hr_b"],["12","hr_d"],["12","rk_b"],["12","rk_d"],["12","rs_b"],["12","rs_d"],["13","vr_c"],["13","hr_c"],["13","rk_c"],["13","rs_c"],["14","vr_c"],["14","hr_c"],["14","rk_c"],["14","rs_c"],["15","vr_c"],["15","hr_c"],["15","rk_c"],["15","rs_c"],["16","vr_c"],["16","hr_c"],["16","rk_c"],["16","rs_c"],["17","vr_d"],["17","hr_d"],["17","rk_d"],["17","rs_d"],["18","vr_b"],["18","vr_d"],["18","hr_b"],["18","hr_d"],["18","rk_b"],["18","rk_d"],["18","rs_b"],["18","rs_d"],["19","hr_a"],["19","hr_b"],["20","hr_a"],["20","hr_b"],["21","hr_a"],["22","hr_a"],["23","hr_b"],["23","hr_d"],["24","hr_a"],["24","hr_b"],["24","rk_a"],["24","rk_b"],["25","vr_b"],["25","vr_d"],["25","hr_b"],["25","hr_d"],["25","rk_b"],["25","rk_d"],["26","rk_b"],["26","rk_d"],["26","rs_b"],["26","rs_d"],["27","hr_d"],["28","vr_b"],["28","vr_d"],["28","hr_b"],["28","hr_d"],["28","rk_b"],["28","rk_d"],["28","rs_b"],["28","rs_d"],["29","vr_b"],["29","vr_d"],["29","hr_b"],["29","hr_d"],["29","rk_b"],["29","rk_d"],["29","rs_b"],["29","rs_d"],["30","hr_b"],["30","hr_d"],["31","rk_d"],["31","rs_d"],["32","vr_b"],["32","vr_d"],["32","hr_b"],["32","hr_d"],["32","rk_b"],["32","rk_d"],["32","rs_b"],["32","rs_d"],["33","vr_a"],["33","hr_a"],["33","rk_a"],["33","rs_a"],["34","rk_b"],["34","rk_d"],["34","rs_b"],["34","rs_d"],["35","vr_a"],["35","hr_a"],["35","rk_a"],["35","rs_a"],["36","rk_d"],["36","rs_d"],["37","vr_d"],["37","hr_d"],["37","rk_d"],["37","rs_d"],["38","vr_c"],["38","hr_c"],["38","rk_c"],["38","rs_c"],["39","vr_c"],["39","hr_c"],["39","rk_c"],["39","rs_c"],["40","vr_a"],["40","hr_a"],["40","rk_a"],["40","rs_a"],["41","vr_b"],["41","vr_d"],["41","hr_b"],["41","hr_d"],["41","rk_b"],["41","rk_d"],["41","rs_b"],["41","rs_d"],["42","vr_b"],["42","hr_b"],["42","rk_b"],["42","rs_b"],["43","vr_d"],["43","hr_d"],["43","rk_d"],["43","rs_d"],["43","3b_d"],["43","3f_d"],["43","5b_d"],["43","5f_d"],["43","7b_d"],["43","7f_d"],["43","9r_d"],["44","vr_d"],["44","hr_d"],["44","rk_d"],["44","rs_d"],["45","vr_d"],["45","hr_d"],["45","rk_d"],["45","rs_d"],["46","rk_b"],["46","rs_b"],["47","vr_d"],["47","hr_d"],["47","rk_d"],["47","rs_d"],["48","vr_b"],["48","vr_d"],["48","hr_b"],["48","hr_d"],["48","rk_b"],["48","rk_d"],["48","rs_b"],["48","rs_d"],["49","vr_d"],["49","hr_d"],["49","rk_d"],["49","rs_d"],["50","vr_b"],["50","vr_d"],["50","hr_b"],["50","hr_d"],["50","rk_b"],["50","rk_d"],["50","rs_b"],["50","rs_d"],["51","vr_b"],["51","vr_d"],["51","hr_b"],["51","hr_d"],["51","rk_b"],["51","rk_d"],["51","rs_b"],["51","rs_d"],["52","vr_c"],["52","hr_c"],["52","rk_c"],["52","rs_c"],["53","vr_d"],["53","hr_d"],["53","rk_d"],["53","rs_d"],["54","hr_d"],["54","rk_d"],["54","rs_d"],["55","hr_d"],["55","rk_d"],["55","rs_d"],["56","vr_d"],["56","hr_d"],["56","rk_d"],["56","rs_d"],["57","vr_d"],["57","hr_d"],["57","rk_d"],["57","rs_d"],["58","vr_d"],["58","hr_d"],["58","rk_d"],["58","rs_d"],["59","vr_d"],["59","hr_d"],["59","rk_d"],["59","rs_d"],["60","vr_d"],["60","hr_c"],["60","rk_c"],["60","rs_c"],["61","vr_b"],["61","vr_d"],["61","hr_b"],["61","hr_d"],["61","rk_b"],["61","rk_d"],["61","rs_b"],["61","rs_d"],["62","vr_c"],["62","vr_d"],["62","hr_c"],["62","hr_d"],["62","rk_c"],["62","rk_d"],["62","rs_c"],["62","rs_d"],["63","vr_d"],["63","hr_c"],["63","rk_c"],["63","rs_c"],["64","vr_d"],["64","hr_d"],["64","rk_d"],["64","rs_d"],["65","vr_a"],["65","hr_a"],["65","rk_a"],["65","rs_a"],["66","vr_b"],["66","vr_d"],["66","hr_b"],["66","hr_d"],["66","rk_b"],["66","rk_d"],["66","rs_b"],["66","rs_d"],["67","vr_c"],["67","vr_d"],["67","hr_c"],["67","hr_d"],["67","rk_c"],["67","rk_d"],["67","rs_c"],["67","rs_d"],["68","vr_c"],["68","vr_d"],["68","hr_c"],["68","hr_d"],["68","rk_c"],["68","rk_d"],["68","rs_c"],["68","rs_d"],["69","vr_c"],["69","hr_c"],["69","rk_c"],["69","rs_c"],["70","rk_d"],["70","rs_d"],["71","3b_a"],["71","3f_a"],["71","5b_a"],["71","5f_a"],["71","7b_a"],["71","7f_a"],["72","3b_d"],["72","3f_d"],["72","5b_d"],["72","5f_d"],["72","7b_d"],["72","7f_d"],["73","3f_a"],["73","5f_a"],["73","7f_a"],["73","9r_a"],["74","3b_b"],["74","3b_d"],["74","5b_b"],["74","5b_d"],["74","7b_b"],["74","7b_d"],["75","3f_c"],["75","5f_c"],["75","7f_c"],["75","9r_c"],["76","3b_c"],["76","3f_c"],["76","5b_c"],["76","5f_c"],["76","7b_c"],["76","7f_c"],["76","9r_c"],["77","3b_a"],["77","3f_a"],["77","5b_a"],["77","5f_a"],["77","7b_a"],["77","7f_a"],["77","9r_a"],["78","7b_d"],["78","7f_d"],["79","3f_a"],["79","5f_a"],["79","7f_a"],["80","3b_c"],["80","3f_c"],["80","5f_c"],["82","3b_a"],["82","5b_a"],["82","7b_a"],["83","3b_a"],["83","5b_a"],["83","7b_a"],["83","7f_d"],["84","3b_d"],["84","3f_d"],["84","5b_d"],["84","5f_d"],["84","7b_d"],["84","7f_d"],["85","3b_d"],["85","3f_d"],["85","5b_d"],["85","5f_d"],["85","7b_d"],["85","7f_d"],["86","3b_a"],["86","3f_a"],["86","5b_a"],["86","5f_a"],["86","7b_a"],["86","7f_a"],["87","3b_a"],["87","3f_a"],["87","5b_a"],["87","5f_a"],["87","7b_a"],["87","7f_a"],["87","9r_a"],["88","3b_a"],["88","3f_a"],["88","5b_a"],["88","5f_a"],["88","7b_a"],["88","7f_a"],["89","3b_a"],["89","3f_a"],["89","5b_a"],["89","5f_a"],["89","7b_a"],["89","7f_a"],["89","9r_a"],["90","3b_a"],["90","3f_a"],["90","5b_a"],["90","5f_a"],["90","7b_a"],["90","7f_a"],["91","3b_d"],["91","3f_d"],["91","5b_d"],["91","5f_d"],["91","7b_d"],["91","7f_d"],["91","9r_d"],["92","3b_c"],["92","3f_c"],["92","5f_c"],["94","3b_c"],["94","3f_c"],["94","5f_c"],["95","hr_d"],["95","rk_d"],["95","rs_d"],["96","hr_d"],["96","rk_d"],["96","rs_d"],["96","3b_d"],["96","3f_d"],["96","5b_d"],["96","5f_d"],["96","7b_d"],["96","7f_d"],["96","9r_d"],["97","hr_d"],["97","rk_d"],["97","rs_d"],["97","3b_d"],["97","3f_d"],["97","5b_d"],["97","5f_d"],["97","7b_d"],["97","7f_d"],["97","9r_d"],["98","hr_d"],["98","rk_d"],["98","rs_d"],["99","vr_b"],["99","hr_b"],["99","hr_d"],["99","rk_b"],["99","rk_d"],["99","rs_b"],["99","rs_d"],["100","3b_a"],["100","5b_a"],["100","7b_a"],["101","rk_b"],["101","rk_d"],["101","rs_b"],["101","rs_d"],["102","vr_d"],["102","hr_c"],["102","rk_c"],["103","3b_a"],["103","3f_a"],["103","5b_a"],["103","5f_a"],["103","7b_a"],["103","7f_a"],["103","9r_a"],["104","3f_c"],["104","5f_c"],["105","3b_a"],["105","5b_a"],["105","7b_a"],["106","3b_a"],["106","5b_a"],["106","7b_a"],["107","3b_a"],["107","3f_a"],["107","5b_a"],["107","5f_a"],["107","7b_a"],["107","7f_b"],["108","3b_a"],["108","3b_b"],["108","3b_d"],["108","5b_a"],["108","5b_b"],["108","5b_d"],["108","7b_a"],["108","7b_b"],["108","7b_d"],["109","3b_d"],["109","3f_d"],["109","5b_d"],["109","5f_d"],["109","7b_d"],["109","7f_d"],["109","9r_d"],["110","hr_c"],["110","rk_c"],["110","rs_c"],["110","3b_d"],["110","3f_d"],["110","5b_d"],["110","5f_d"],["110","7b_d"],["110","7f_d"],["110","9r_d"],["111","vr_b"],["111","hr_b"],["111","rk_b"],["111","rs_b"],["112","vr_c"],["112","vr_d"],["112","hr_c"],["112","hr_d"],["112","rk_c"],["112","rk_d"],["112","rs_c"],["112","rs_d"],["113","3b_a"],["113","5b_a"],["113","7b_a"],["114","hr_d"],["114","rk_d"],["114","rs_d"],["114","3b_d"],["114","3f_d"],["114","5b_d"],["114","5f_d"],["114","7b_d"],["114","7f_d"],["114","9r_d"],["115","hr_d"],["115","rk_d"],["115","rs_d"],["115","3b_d"],["115","3f_d"],["115","5b_d"],["115","5f_d"],["115","7b_d"],["115","7f_d"],["115","9r_d"],["116","vr_a"],["116","hr_a"],["116","rk_a"],["116","rs_a"],["116","3b_a"],["116","3f_a"],["116","5b_a"],["116","5f_a"],["116","7b_a"],["116","7f_a"],["116","9r_a"],["117","3b_a"],["117","5b_a"],["117","7b_a"],["118","hr_d"],["118","rk_d"],["118","3b_d"],["118","3f_d"],["118","5b_d"],["118","5f_d"],["118","7b_d"],["118","7f_d"],["118","9r_d"],["119","vr_a"],["119","hr_a"],["119","rk_a"],["119","rs_a"],["119","3b_a"],["119","3f_a"],["119","5b_a"],["119","5f_a"],["119","7b_a"],["119","7f_a"],["119","9r_a"],["120","hr_d"],["120","rk_d"],["120","rs_d"],["120","3b_d"],["120","3f_d"],["120","5b_d"],["120","5f_d"],["120","7b_d"],["120","7f_d"],["120","9r_d"],["121","hr_d"],["121","rk_d"],["121","rs_d"],["121","3b_d"],["121","3f_d"],["121","5b_d"],["121","5f_d"],["121","7b_d"],["121","7f_d"],["121","9r_d"],["122","3b_a"],["122","5b_a"],["122","7b_a"],["123","5b_a"],["123","5f_a"],["123","9r_a"],["124","3b_a"],["124","3f_a"],["124","5b_a"],["124","5f_a"],["124","7b_a"],["124","7f_a"],["125","3b_b"],["125","3b_d"],["125","3f_b"],["125","3f_d"],["125","5b_b"],["125","5b_d"],["125","5f_b"],["125","5f_d"],["125","7b_b"],["125","7b_d"],["125","7f_b"],["125","7f_d"],["126","5b_b"],["126","5b_d"],["126","5f_b"],["126","5f_d"],["126","7b_b"],["126","7b_d"],["126","7f_b"],["126","7f_d"],["127","3b_d"],["127","3f_d"],["127","7b_d"],["127","7f_d"],["128","7b_c"],["128","7f_c"],["129","3b_b"],["129","3b_d"],["129","3f_b"],["129","3f_d"],["129","5b_b"],["129","5b_d"],["129","5f_b"],["129","5f_d"],["129","7b_b"],["129","7b_d"],["129","7f_b"],["129","7f_d"],["130","3b_d"],["130","3f_d"],["130","5b_d"],["130","5f_d"],["130","7b_d"],["130","7f_d"],["131","7b_b"],["131","7f_b"],["132","3b_a"],["132","5b_a"],["132","7b_a"],["133","3b_a"],["133","5b_a"],["133","7b_a"],["134","3b_b"],["134","3b_d"],["134","5b_b"],["134","5b_d"],["134","7b_b"],["134","7b_d"],["135","3b_b"],["135","3b_d"],["135","5b_b"],["135","5b_d"],["135","7b_b"],["135","7b_d"],["137","3b_d"],["137","3f_d"],["137","5b_d"],["137","5f_d"],["137","7b_d"],["137","7f_d"],["137","9r_d"],["138","3b_d"],["138","3f_d"],["138","5b_d"],["138","5f_d"],["138","7b_d"],["138","7f_d"],["138","9r_d"],["139","3f_a"],["139","5f_a"],["139","7f_a"],["139","9r_a"],["140","3f_a"],["140","5f_a"],["140","7f_a"],["140","9r_a"],["141","3b_d"],["141","3f_d"],["141","5b_d"],["141","5f_d"],["141","7b_d"],["141","7f_d"],["142","3b_a"],["142","3f_a"],["142","5b_a"],["142","5f_a"],["142","7b_a"],["142","7f_a"],["142","9r_a"],["143","9r_a"],["144","9r_a"],["145","9r_a"],["146","9r_a"],["147","9r_b"],["148","9r_b"],["149","9r_b"],["150","9r_b"],["151","9r_b"],["152","9r_b"],["153","9r_b"],["154","9r_c"],["156","9r_d"]]

const sql = (file) => {
  let fullPath = path.join(__dirname, '../db/queries/questions/', file)

  if (environment === 'production') {
    fullPath = path.join(__dirname, '../../db/queries/productQuestionLinks/', file);
  }
  return new QueryFile(fullPath, {minify: true});
}

const queries = {
  addProductQuestionLinks: sql('addProductQuestionLink.sql'),
};

// const limit = pLimit(10)

export const addProductQuestionLinks = (items) => {
  items.forEach(item => {
    const [ question_id, product_id ] = item
    db.none(queries.addProductQuestionLinks, { question_id, product_id })
    .then(res => console.log('Success adding product question'))
    .catch(err => console.log('Error: ', err))
  })
}

// const addQuestionPLimit = async () => {
//   let promises = productQuestions.map(([question_id, product_id]) => limit(() => db.none(queries.addProductQuestionLinks, { question_id, product_id })))
  
//   let insertedQuestionPromises = await Promise.all(promises)

// }

// addQuestionPLimit()
